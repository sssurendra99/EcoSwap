<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/dashboard_layout}">
<head>
    <title>My Orders - EcoSwap</title>
    <link th:href="@{/css/profile.css}" rel="stylesheet"/>
</head>
<body>

<div layout:fragment="content">
    <!-- Page Header -->
    <div class="page-header">
        <div class="header-content">
            <div>
                <h1>My Orders</h1>
                <p class="subtitle">View and track all your orders</p>
            </div>
            <a th:href="@{/profile}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Profile
            </a>
        </div>
    </div>

    <div class="orders-container">
        <!-- Orders Summary -->
        <div class="orders-stats">
            <div class="stat-card">
                <i class="fas fa-shopping-bag"></i>
                <div class="stat-info">
                    <span class="stat-label">Total Orders</span>
                    <span class="stat-value" th:text="${totalItems}">0</span>
                </div>
            </div>
        </div>

        <!-- Orders List -->
        <div class="profile-card" th:if="${!orders.isEmpty()}">
            <div class="card-header">
                <h3><i class="fas fa-list"></i> Order History</h3>
            </div>
            <div class="card-body">
                <div class="orders-table">
                    <div class="order-row header-row">
                        <div class="order-col">Order Number</div>
                        <div class="order-col">Date</div>
                        <div class="order-col">Items</div>
                        <div class="order-col">Total</div>
                        <div class="order-col">Status</div>
                        <div class="order-col">Actions</div>
                    </div>

                    <div class="order-row" th:each="order : ${orders}">
                        <div class="order-col">
                            <span class="order-number">#<span th:text="${order.orderNumber}">12345</span></span>
                        </div>
                        <div class="order-col">
                            <span th:text="${#temporals.format(order.orderDate, 'MMM dd, yyyy')}">Jan 01, 2024</span>
                        </div>
                        <div class="order-col">
                            <span th:text="${order.orderItems.size()} + ' items'">3 items</span>
                        </div>
                        <div class="order-col">
                            <span class="order-amount">$<span th:text="${#numbers.formatDecimal(order.totalAmount, 1, 2)}">0.00</span></span>
                        </div>
                        <div class="order-col">
                            <span class="order-status"
                                  th:classappend="${order.status}"
                                  th:text="${order.status}">Pending</span>
                        </div>
                        <div class="order-col">
                            <a th:href="@{/dashboard/orders/{id}(id=${order.id})}" class="btn-view">
                                <i class="fas fa-eye"></i> View
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination" th:if="${totalPages > 1}">
                    <a th:href="@{/profile/orders(page=${currentPage - 1})}"
                       class="pagination-btn"
                       th:classappend="${currentPage == 0} ? 'disabled' : ''"
                       th:if="${currentPage > 0}">
                        ← Previous
                    </a>

                    <div class="pagination-numbers">
                        <span th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}"
                              th:if="${pageNum >= currentPage - 2 and pageNum <= currentPage + 2}">
                            <a th:href="@{/profile/orders(page=${pageNum})}"
                               class="pagination-number"
                               th:classappend="${pageNum == currentPage} ? 'active' : ''"
                               th:text="${pageNum + 1}">1</a>
                        </span>
                    </div>

                    <a th:href="@{/profile/orders(page=${currentPage + 1})}"
                       class="pagination-btn"
                       th:classappend="${currentPage >= totalPages - 1} ? 'disabled' : ''"
                       th:if="${currentPage < totalPages - 1}">
                        Next →
                    </a>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="profile-card" th:if="${orders.isEmpty()}">
            <div class="card-body">
                <div class="empty-state">
                    <i class="fas fa-shopping-bag"></i>
                    <h3>No Orders Yet</h3>
                    <p>You haven't placed any orders. Start shopping to see your orders here!</p>
                    <a href="/shop" class="btn btn-primary">Browse Products</a>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
